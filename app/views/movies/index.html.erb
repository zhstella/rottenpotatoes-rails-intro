<!--  This file is app/views/movies/index.html.erb -->
<h2>All Movies</h2>
<%= form_tag movies_path, method: :get, id: "ratings_form" do %>
  <div>
    <h3>Filter by ratings:</h3>
    <% @all_ratings.each do |rating| %>
      <div class="form-check form-check-inline">
        <%= check_box_tag "ratings[#{rating}]", 1, @ratings_to_show.include?(rating), id: "ratings_#{rating}" %>
        <%= label_tag "ratings_#{rating}", rating, class: "form-check-label" %>
      </div>
    <% end %>
  </div>

  <div class="mt-3">
    <label class="form-label me-2" for="sort_by">Sort by:</label>
    <%= select_tag :sort_by,
                   options_for_select([["Title", "title"],
                                       ["Release date", "release_date"]],
                                       @sort_by),
                   id:    "sort_by",
                   class: "form-select d-inline w-auto" %>
  </div>

  <div class="mt-3">
    <%= submit_tag "Refresh", id: "ratings_submit", class: "btn btn-primary" %>
  </div>
<% end %>

<%#  Part 1: Start here... %>

<div class="container" id="movies">

  <%# 1. 这是表头 (Header Row)，用 div 实现 %>
  <%# d-none d-md-flex 类让表头在小屏幕上隐藏，在大屏幕上显示为 flex 布局 %>
  <div class="row font-weight-bold py-2 border-bottom d-none d-md-flex">
    <div class="col-md-3">Movie Title</div>
    <div class="col-md-2">Rating</div>
    <div class="col-md-4">Release Date</div>
    <div class="col-md-3">More Info</div>
  </div>

  <%# 2. 遍历 @movies 集合，为每部电影创建一个 div "行" %>
  <% @movies.each do |movie| %>
    <%# 这个 div 就是测试脚本期望找到的代表单个电影的 div 元素 %>
    <div class="row py-2 border-top">
      <%# 下面是电影的 "单元格"，用带列(col)的 div 实现 %>
      <div class="col-md-3"><%= movie.title %></div>
      <div class="col-md-2"><%= movie.rating %></div>
      <div class="col-md-4"><%= movie.release_date %></div>
      <div class="col-md-3"><%= link_to "More about #{movie.title}", movie_path(movie) %></div>
    </div>
  <% end %>
</div>


<%= link_to 'Add new movie', new_movie_path, :class => 'btn btn-primary' %>
